<!DOCTYPE HTML>
<html lang="en-US">
  <!--  -->
<head>
<meta charset="utf-8">
  <meta name="veiwport" content="width=device.width, initial-scale=1">
  <title>Map 5: The Roman World</title>
</head>

<style>
    * {
    font-family: sans-serif;
    font-size: 30px;
  }
  
  .bolded {
    font-weight: bold;
  }
</style>

<body>
  <h1>Geography Quiz 5: Ancient Rome and the Rise of Christianity</h1>
  <p><span id="modeIndicator"></span> Instructions:</p>
  <ul>
    <li>Press 1 through 9 and 0 to select a question, 0 being question 10</li>
    <li>Press A through J to select a location</li>
    <li>Press Enter to pair the selected question with the selected location</li>
  </ul>
  <div id="Map">
    <img id ="map" src="./Images/Base Map.png" alt="Map of Ancient World Civilizations">
  </div>
  
  <p id="Selected Question"><b>Selected Question: </b><span id="questionText"></span></p>
  <p id="Selected Location"><b>Selected Location: </b><span id="locationText"></span></p>
  
  <div id="quiz">
    <p id="q1"><span id="q1 num">1. </span>_<span id="q1 answer"></span>_<span id="q1 grade"></span></p>
    <p id="q2"><span id="q2 num">2. </span>_<span id="q2 answer"></span>_<span id="q2 grade"></span></p>
    <p id="q3"><span id="q3 num">3. </span>_<span id="q3 answer"></span>_<span id="q3 grade"></span></p>
    <p id="q4"><span id="q4 num">4. </span>_<span id="q4 answer"></span>_<span id="q4 grade"></span></p>
    <p id="q5"><span id="q5 num">5. </span>_<span id="q5 answer"></span>_<span id="q5 grade"></span></p>
    <p id="q6"><span id="q6 num">6. </span>_<span id="q6 answer"></span>_<span id="q6 grade"></span></p>
    <p id="q7"><span id="q7 num">7. </span>_<span id="q7 answer"></span>_<span id="q7 grade"></span></p>
    <p id="q8"><span id="q8 num">8. </span>_<span id="q8 answer"></span>_<span id="q8 grade"></span></p>
    <p id="q9"><span id="q9 num">9. </span>_<span id="q9 answer"></span>_<span id="q9 grade"></span></p>
    <p id="q10"><span id="q10 num">10. </span>_<span id="q10 answer"></span>_<span id="q10 grade"></span></p>
  </div>

<script src="../quiz_classes.js"></script> <!-- Contains js classes Location and Question -->
<script>
  // When this is true, "Correct!" will appear next to correct answers.
  var studyMode = true;
  
  // These three (questionText, locationText, correctAnswers) are the only var that need changing between quizzes.
  // The question text is sourced from the quizzes prompts
  var questionText = [
    "1. Macedonia", 
    "2. Spain", 
    "3. Asia Minor", 
    "4. Syria", 
    "5. Rome", 
    "6. Numidia, once controlled by Carthage",
    "7. Egypt, which allied itself with Rome",
    "8. Gaul, where Julius Caesar won many military victories",
    "9. Britain, where Hadrian built a wall",
    "10. Constantinople, the \"New Rome\" Constantine renamed for himself"];
  // These location descriptions are custom made (not sourced from the quiz)
  var locationText = [
    "A is a large region near the center of the upper-left portion of the map.",
    "B is a small region near the middle of the right edge of the map.", 
    "C is a region just to the right of the center of the map.",
    "D is a region near the bottom-left of the map.",
    "E is a city just to the left of the center of the map.",
    "F is a large region near the right side of the map.",
    "G is a large region near the left side of the map.",
    "H is a city near the middle of the right half of the map.",
    "I is a large region near the lower-right portion of the map.",
    "J is a region in the left area of the top edge of the map."]
  // Index corresponds to qArray; value corresponds to locArray index.
  var correctAnswers = [2, 6, 5, 1, 4, 3, 8, 0, 9, 7];
  
  // Events for user functions
  window.addEventListener("keydown", onKeyDown);
  
  // Preparing arrays for the questions and locations
  var locArray = prepLocArray();
  var qArray = prepQArray();
  
  // Filling locArray and qArray with quiz-specific information
  for (var i = 0; i < locArray.length; i++) {
    locArray[i].description = locationText[i];
  }
  for (var i = 0; i < qArray.length; i++) {
    qArray[i].quizText = questionText[i];
    qArray[i].pairedLocation = correctAnswers[i];
  }
  
  // This only serves to clarify to the user which mode the page is in.
  if (studyMode) { document.getElementById("modeIndicator").innerHTML = "Study Mode"; }
  else { document.getElementById("modeIndicator").innerHTML = "Quiz Mode"; }

  // -1 means no Question/Location is selected
  var selectedQuestion = -1;
  var selectedLocation = -1;
  
  // Used to track correct answers for reporting when studyMode = true
  var isAnsCorrect = [false, false, false, false, false, false, false, false, false, false];
  
  // Changes Map image to one that highlights the selected location; changes image's alt text; displays image description
  function changeMap(indexNum) {
    var map = document.getElementById("map");
    if (indexNum == -1) {
      map.src = "./Images/Base Map.png";
      map.alt = "Base Map";
      document.getElementById("locationText").innerHTML = "No location is selected";
    }
    else {
      map.src = locArray[indexNum].imgSrc;
      map.alt = locArray[indexNum].imgAlt;
      document.getElementById("locationText").innerHTML = locArray[indexNum].description;
    }
  }
  
  // Used when unselecting a location (e.g. pressing A when A is currently selected)
  function resetMap() {
    selectedLocation = -1;
    changeMap(-1);
  }
  
  // Adds bolded class to the question's number (e.g. the '1.' in '1. __')
  function boldQNum (indexNum) {
    if (indexNum == -1) { return; }
    document.getElementById(qArray[indexNum].qNumId).classList.add("bolded");
  }
  
  // Calls boldQNum and changes the text displayed next to "Selected Location: " on the page
  function changeQuestion(indexNum) {
  if (indexNum == -1) {
    document.getElementById("questionText").innerHTML = "No question is selected";
    return;
  }
    boldQNum(indexNum);
    document.getElementById("questionText").innerHTML = qArray[indexNum].quizText;
  }
  
  // Removes bolded class from question's number when it is not selected
  function unboldQNum (indexNum) {
    if (indexNum == -1) { return; }
    document.getElementById(qArray[indexNum].qNumId).classList.remove("bolded");
  }
  
  // Unselects any selected question and changes the text displayed next to "Selected Question: " on the page
  function resetQuestion() {
    selectedQuestion = -1;
    changeQuestion(-1);
  }
  
  // Checks given answer against correctAnswers and changes isAnsCorrect; only used when studyMode == true
  function checkAnswer(qIndex) {
    if (document.getElementById(qArray[qIndex].qAnsId).innerHTML == locArray[qArray[qIndex].pairedLocation].letter) {
      isAnsCorrect[qIndex] = true;
    }
    else {
      isAnsCorrect[qIndex] = false;
    }
  }
  
  // Appends and removes "Correct!" to question line; only used when studyMode == true
  function reportCorrect(qIndex) {
    if (isAnsCorrect[qIndex]) {
      document.getElementById(qArray[qIndex].qGradeId).innerHTML = " Correct!";
    }
    else {
      document.getElementById(qArray[qIndex].qGradeId).innerHTML = "";
    }
  }
 
  // These are the user's controls 
  function onKeyDown(event) {
    switch (event.keyCode) {
      // Pair selectedQuestion with selectedLocation
      case 13: // Enter
        console.log("Before: " + isAnsCorrect);
        if (selectedQuestion != -1) {
          if (selectedLocation == -1) {
            document.getElementById(qArray[selectedQuestion].qAnsId).innerHTML = "";
          }
          else {
            document.getElementById(qArray[selectedQuestion].qAnsId).innerHTML = 
              locArray[selectedLocation].letter;
          }
          if (studyMode) {
            checkAnswer(selectedQuestion, selectedQuestion);
            reportCorrect(selectedQuestion);
          }
        }
        console.log("After: " + isAnsCorrect);
        break;

      // Selecting the active question with 1-9, 0 for 1-10
      case 48: // 0, but I'm using it to mean 10
        unboldQNum(selectedQuestion);
        if (selectedQuestion == 9) { resetQuestion(); }
        else {
          selectedQuestion = 9;
          changeQuestion(9);
        }
        break;
      case 49: // 1
      case 50: // 2
      case 51: // 3
      case 52: // 4
      case 53: // 5
      case 54: // 6
      case 55: // 7
      case 56: // 8
      case 57: // 9
        unboldQNum(selectedQuestion);
        if (selectedQuestion == event.keyCode - 49) { resetQuestion(); }
        else {
          selectedQuestion = event.keyCode - 49;
          changeQuestion(event.keyCode - 49);
        }
        break;

      // Selecting location with a-j
      case 65: // a
      case 66: // b
      case 67: // c
      case 68: // d
      case 69: // e
      case 70: // f
      case 71: // g
      case 72: // h
      case 73: // i
      case 74: // j
        if (selectedLocation == (event.keyCode - 65)) { resetMap(); }
        else {
          selectedLocation = (event.keyCode - 65);
          changeMap((event.keyCode - 65));
        }
        break;

      default: // Key pressed was not on list (0-9, a-j, Enter)
        break;
      }
  }
</script>
</body>
</html>